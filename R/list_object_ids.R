#' List all object ids in the RATO ArcGIS Enterprise MapServer
#'
#' @param token Access token, by default generated by `get_token()`
#'
#' @return Integer vector of (all) object ids.
#' @export
list_object_ids <- function(token = get_token()) {

  object_ids_response <-
    httr2::request("https://gis.oost-vlaanderen.be/server/rest/services/") %>%
    httr2::req_url_path_append("RATO2",
                        "RATO2_Dossiers_Publiek",
                        "MapServer",
                        "0",
                        "query"
                        ) %>%
    httr2::req_url_query(
      where = "1=1",
      returnIdsOnly = "true",
      f = "pjson",
      token = token
    ) %>%
    httr2::req_perform() %>%
    httr2::resp_body_json(check_type = FALSE)

  object_ids_response %>%
    purrr::chuck("objectIds") %>%
    unlist() %>%
    return()
}
